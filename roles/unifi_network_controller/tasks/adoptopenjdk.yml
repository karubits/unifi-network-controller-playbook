---
  - name: ensure common packages are installed
    apt:
      state: present
      pkg:
        - gnupg
        - software-properties-common

  - name: ensure adopt open jdk apt key is present
    apt_key:
      url: https://adoptopenjdk.jfrog.io/adoptopenjdk/api/gpg/key/public
      state: present

  - name: ensure the adoptjdk repoistory is present
    ansible.builtin.apt_repository:
      repo: deb https://adoptopenjdk.jfrog.io/adoptopenjdk/deb/ {{ ansible_distribution_release }} main
      state: present
      filename: adoptopenjdk
    when: ansible_distribution_release != "jammy" # Jammy Jellyfish currently does not have a release

  - name: "[Ubuntu 22.04] ensure the adoptjdk repoistory is present"
    ansible.builtin.apt_repository:
      repo: deb https://adoptopenjdk.jfrog.io/adoptopenjdk/deb/ focal main
      state: present
      filename: adoptopenjdk
    when: ansible_distribution_release == "jammy"

  - name: ensure adopt JDK-8 hotspot JRE hotspot is installed
    apt:
      state: present
      name: adoptopenjdk-8-hotspot-jre
      update_cache: yes

  - name: set JAVA_HOME default location
    lineinfile:
      dest: /root/.bashrc
      line: 'export JAVA_HOME=/usr/lib/jvm/adoptopenjdk-8-hotspot-amd64/bin/java'
      state: present
